version: '3.8'
services:
  # The Redis service for our Blackboard
  redis:
    image: redis:alpine
    ports:
      - "6379:6379"
    volumes:
      - redis_data:/data

  # The main user-facing application loop
  main_loop:
    build: .
    command: python ark_main.py
    depends_on:
      - redis
    stdin_open: true # Allows us to type input into the container
    tty: true        # Connects our terminal to the container

  # The background orchestrator for T2 agents
  orchestrator:
    build: .
    command: python agents/orchestrator.py
    depends_on:
      - redis

  # A T1 scout worker (we can scale this later)
  scout_1:
    build: .
    command: python agents/scout_agent.py
    depends_on:
      - redis

volumes:
  redis_data:
